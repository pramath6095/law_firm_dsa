<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Cases - Legal Case Management</title>
    <link rel="stylesheet" href="../styles.css">
</head>

<body>
    <div class="header">
        <div class="header-content">
            <h1>Legal Case Management - Lawyer Portal</h1>
            <nav class="nav-links">
                <a href="dashboard.html">Dashboard</a>
                <a href="cases.html">My Cases</a>
                <a href="profile.html">Profile</a>
                <button class="btn btn-secondary" onclick="handleLogout()">Logout</button>
            </nav>
        </div>
    </div>

    <div class="container">
        <h2>My Cases</h2>

        <div id="cases-list">
            <p class="loading">Loading cases...</p>
        </div>
    </div>

    <script src="../app.js"></script>
    <script>
        if (!requireAuth('lawyer')) {
            // Redirected
        }

        async function loadCases() {
            try {
                const data = await API.getLawyerCases();

                const casesDiv = document.getElementById('cases-list');

                if (data.cases && data.cases.length > 0) {
                    casesDiv.innerHTML = data.cases.map(c => {
                        const urgencyClass = c.urgency_level === 'urgent' ? 'urgent' :
                            c.urgency_level === 'high' ? 'high' : 'normal';
                        const daysText = c.days_until_hearing !== undefined ?
                            `Hearing in ${c.days_until_hearing} days` : '';

                        return `
                        <div class="case-item ${urgencyClass}" onclick="window.location.href='case-details.html?id=${c.case_id}'">
                            <div class="case-id">${c.case_id}</div>
                            <div class="case-type">${c.case_type}</div>
                            <div class="case-days">${daysText}</div>
                            <span class="case-status status-${c.status}">${formatStatus(c.status)}</span>
                        </div>
                    `}).join('');
                } else {
                    casesDiv.innerHTML = '<p class="text-muted">No cases assigned</p>';
                }

            } catch (error) {
                console.error('Error loading cases:', error);
                showAlert('Error loading cases: ' + error.message, 'error');
            }
        }

        loadCases();
    </script>
</body>

</html>